# Project-specific values for AWS EKS deployment
# This file overrides the base values in my-recipes-chart/values.yaml

global:
  namespace: my-apps

# AWS Configuration (default, overridden by environment files)
aws:
  region: eu-central-1

# Backend configuration
backend:
  name: backend
  replicaCount: 1
  image:
    repository: 430842105273.dkr.ecr.eu-central-1.amazonaws.com/my-recipes-backend  # Update with your ECR repository
    tag: "v3"
    pullPolicy: Always
  
  service:
    type: ClusterIP
    port: 80
    targetPort: 8000
  
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  
  ingress:
    enabled: true
    className: "alb"
    annotations:
      alb.ingress.kubernetes.io/scheme: internet-facing
      alb.ingress.kubernetes.io/target-type: ip
      alb.ingress.kubernetes.io/listen-ports: '[{"HTTPS":443}]'
      # Add your ACM certificate ARN below if you have one
      # alb.ingress.kubernetes.io/certificate-arn: "arn:aws:acm:..."
    hosts:
      - host: api-my-recipes.aws-dvirlabs.com
        paths:
          - path: /
            pathType: Prefix

# Frontend configuration
frontend:
  name: frontend
  replicaCount: 1
  image:
    repository: 430842105273.dkr.ecr.eu-central-1.amazonaws.com/my-recipes-frontend  # Update with your ECR repository
    tag: "latest"
    pullPolicy: Always
  
  service:
    type: ClusterIP
    port: 80
    targetPort: 80
  
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi
  
  env:
    API_BASE: "https://api-my-recipes.aws-dvirlabs.com"
  
  ingress:
    enabled: true
    className: "alb"
    annotations:
      alb.ingress.kubernetes.io/scheme: internet-facing
      alb.ingress.kubernetes.io/target-type: ip
      alb.ingress.kubernetes.io/listen-ports: '[{"HTTPS":443}]'
      # Add your ACM certificate ARN below if you have one
      # alb.ingress.kubernetes.io/certificate-arn: "arn:aws:acm:..."
    hosts:
      - host: my-recipes.aws-dvirlabs.com
        paths:
          - path: /
            pathType: Prefix
  
  externalUrl: "https://my-recipes.aws-dvirlabs.com"

# PostgreSQL configuration
postgres:
  name: db
  # For AWS RDS, set this to use external database
  # Leave enabled: true to use in-cluster database
  enabled: false  # Set to false if using RDS
  
  user: recipes_user
  database: recipes_db
  port: 5432
  
  image:
    repository: postgres
    tag: "16-alpine"
    pullPolicy: IfNotPresent
  
  service:
    type: ClusterIP
    port: 5432
  
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  
  # If using RDS, these values are ignored but kept for reference
  persistence:
    accessMode: ReadWriteOnce
    storageClass: "gp3"  # EKS default storage class
    size: 20Gi

# OAuth Configuration - Using External Secrets from AWS Secrets Manager
# All sensitive values are managed through ExternalSecret resources
# See templates/app-secrets.yaml for the ExternalSecret configuration

# Email Configuration - Using External Secrets from AWS Secrets Manager
# All sensitive values are managed through ExternalSecret resources
# See templates/app-secrets.yaml for the ExternalSecret configuration

# S3 Backup Configuration for AWS
s3:
  endpoint: "https://s3.eu-central-1.amazonaws.com"  # Update with your region
  bucketName: "my-recipes-backups"  # Update with your S3 bucket name
  region: "eu-central-1"  # Update with your region
  backupInterval: "weekly"
  # accessKey and secretKey are managed through External Secrets

# Admin User Configuration - Using External Secrets from AWS Secrets Manager
# All sensitive values are managed through ExternalSecret resources
admin:
  username: "admin"
  email: "admin@example.com"
  password: "admin123"  # Default password - change after first login
  firstName: "Admin"
  lastName: "User"
  displayName: "Admin User"

# Database connection for AWS RDS (used when postgres.enabled: false)
database:
  host: "my-recipes-rds.chw4omcguqv7.eu-central-1.rds.amazonaws.com"
  port: "5432"
  name: "recipes_db"
  user: "recipes_user"
  password: "recipes_password"  # Store securely in AWS Secrets Manager in production
